{"ast":null,"code":"import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{useSelector}from\"react-redux\";import{Table,Select}from\"antd\";import useAuthorize from\"../../../utils/authorization\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Option=Select.Option;function GestorVoluntarios(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),rol=_useState2[0],setRol=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var user=useSelector(function(state){return state.user;});var roles=useSelector(function(state){return state.roles.filter(function(rol){return rol.id>2;});});useEffect(function(){axios.get(\"/api/users/sede/\".concat(user.sedeId)).then(function(res){return res.data;}).then(function(users){return setUsers(users.filter(function(userFilter){return userFilter.id!==user.id;}));});},[user]);var handleChange=function handleChange(e){setRol(e);};var handleClick=function handleClick(userId,rolId){axios.post(\"http://localhost:3001/api/roles/set/\",{userId:userId,rolId:rolId,user:user}).then(function(){axios.get(\"/api/users/sede/\".concat(user.sedeId)).then(function(res){return res.data;}).then(function(users){return setUsers(users.filter(function(userFilter){return userFilter.id!==user.id;}));});});};useAuthorize(user,2);var dataSource=users.map(function(user){var _user$rol;return{key:user.id,nombre:user.full_name,rol:(_user$rol=user.rol)===null||_user$rol===void 0?void 0:_user$rol.tipo};});var columns=[{title:\"Voluntario\",render:function render(record){return/*#__PURE__*/_jsxs(React.Fragment,{children:[record.nombre,/*#__PURE__*/_jsx(\"hr\",{}),record.rol]});},responsive:[\"xs\"]},{title:\"Nombre\",dataIndex:\"nombre\",key:\"nombre\",responsive:[\"sm\"]},{title:\"Rol\",dataIndex:\"rol\",key:\"rol\",responsive:[\"sm\"]},{title:\"Seleccionar rol\",key:\"seleccionar rol\",render:function render(text,record){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Select,{defaultValue:\"Seleccionar rol\",style:{width:200},onChange:handleChange,children:roles&&roles.map(function(rol){return/*#__PURE__*/_jsxs(Option,{value:rol.id,children:[\" \",rol.tipo,\" \"]},rol.id);})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleClick(record.key,parseInt(rol));},className:\"btn btn-outline-primary mx-1\",children:\"Asignar rol\"})]});}}];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fs-3 text-secondary p-5 text-center\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Administrar roles\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Table,{dataSource:dataSource,columns:columns,pagination:false})})]});}export default GestorVoluntarios;","map":null,"metadata":{},"sourceType":"module"}