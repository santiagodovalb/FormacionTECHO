{"ast":null,"code":"import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{useSelector}from\"react-redux\";import{Table,Select}from\"antd\";import useAuthorize from\"../../../utils/authorization\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Option=Select.Option;function GestorVoluntarios(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),rol=_useState2[0],setRol=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var user=useSelector(function(state){return state.user;});var roles=useSelector(function(state){return state.roles.filter(function(rol){return rol.id>2;});});useEffect(function(){axios.get(\"/api/users/sede/\".concat(user.sedeId)).then(function(res){return res.data;}).then(function(users){return setUsers(users.filter(function(userFilter){return userFilter.id!==user.id;}));});},[user]);var handleChange=function handleChange(e){setRol(e);};var handleClick=function handleClick(userId,rolId){axios.post(\"http://localhost:3001/api/roles/set/\",{userId:userId,rolId:rolId,user:user}).then(function(){axios.get(\"/api/users/sede/\".concat(user.sedeId)).then(function(res){return res.data;}).then(function(users){return setUsers(users.filter(function(userFilter){return userFilter.id!==user.id;}));});});};useAuthorize(user,2);var dataSource=users.map(function(user){var _user$rol;return{key:user.id,nombre:user.full_name,rol:(_user$rol=user.rol)===null||_user$rol===void 0?void 0:_user$rol.tipo};});var columns=[{title:\"Voluntario\",render:function render(record){return/*#__PURE__*/_jsxs(React.Fragment,{children:[record.nombre,/*#__PURE__*/_jsx(\"hr\",{}),record.rol]});},responsive:[\"xs\"]},{title:\"Nombre\",dataIndex:\"nombre\",key:\"nombre\",responsive:[\"sm\"]},{title:\"Rol\",dataIndex:\"rol\",key:\"rol\",responsive:[\"sm\"]},{title:\"Seleccionar rol\",key:\"seleccionar rol\",render:function render(text,record){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Select,{defaultValue:\"Seleccionar rol\",style:{width:200},onChange:handleChange,children:roles&&roles.map(function(rol){return/*#__PURE__*/_jsxs(Option,{value:rol.id,children:[\" \",rol.tipo,\" \"]},rol.id);})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleClick(record.key,parseInt(rol));},className:\"btn btn-outline-primary mx-1\",children:\"Asignar rol\"})]});}}];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fs-3 text-secondary p-5 text-center\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Administrar roles\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Table,{dataSource:dataSource,columns:columns,pagination:false})})]});}export default GestorVoluntarios;","map":{"version":3,"sources":["/home/santi/P5/TECHO/formacion-techo/client/src/containers/Gestor/GestorVoluntarios/GestorVoluntarios.jsx"],"names":["React","useState","useEffect","axios","useSelector","Table","Select","useAuthorize","Option","GestorVoluntarios","rol","setRol","users","setUsers","user","state","roles","filter","id","get","sedeId","then","res","data","userFilter","handleChange","e","handleClick","userId","rolId","post","dataSource","map","key","nombre","full_name","tipo","columns","title","render","record","responsive","dataIndex","text","width","parseInt"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useSelector } from \"react-redux\";\nimport { Table, Select } from \"antd\";\nimport useAuthorize from \"../../../utils/authorization\";\nconst { Option } = Select;\n\nfunction GestorVoluntarios() {\n  const [rol, setRol] = useState(0);\n  const [users, setUsers] = useState([]);\n  const user = useSelector((state) => state.user);\n  const roles = useSelector((state) => state.roles.filter((rol) => rol.id > 2));\n\n  useEffect(() => {\n    axios\n      .get(`/api/users/sede/${user.sedeId}`)\n      .then((res) => res.data)\n      .then((users) =>\n        setUsers(users.filter((userFilter) => userFilter.id !== user.id))\n      );\n  }, [user]);\n\n  const handleChange = (e) => {\n    setRol(e);\n  };\n\n  const handleClick = (userId, rolId) => {\n    axios\n      .post(\"http://localhost:3001/api/roles/set/\", { userId, rolId, user })\n      .then(() => {\n        axios\n          .get(`/api/users/sede/${user.sedeId}`)\n          .then((res) => res.data)\n          .then((users) =>\n            setUsers(users.filter((userFilter) => userFilter.id !== user.id))\n          );\n      });\n  };\n\n  useAuthorize(user, 2);\n\n  const dataSource = users.map((user) => {\n    return {\n      key: user.id,\n      nombre: user.full_name,\n      rol: user.rol?.tipo,\n    };\n  });\n\n  const columns = [\n    {\n      title: \"Voluntario\",\n      render: (record) => (\n        <React.Fragment>\n          {record.nombre}\n          <hr />\n          {record.rol}\n        </React.Fragment>\n      ),\n      responsive: [\"xs\"],\n    },\n    {\n      title: \"Nombre\",\n      dataIndex: \"nombre\",\n      key: \"nombre\",\n      responsive: [\"sm\"],\n    },\n    {\n      title: \"Rol\",\n      dataIndex: \"rol\",\n      key: \"rol\",\n      responsive: [\"sm\"],\n    },\n    {\n      title: \"Seleccionar rol\",\n      key: \"seleccionar rol\",\n      render: (text, record) => {\n        return (\n          <div>\n            <Select\n              defaultValue=\"Seleccionar rol\"\n              style={{ width: 200 }}\n              onChange={handleChange}\n            >\n              {roles &&\n                roles.map((rol) => {\n                  return (\n                    <Option key={rol.id} value={rol.id}>\n                      {\" \"}\n                      {rol.tipo}{\" \"}\n                    </Option>\n                  );\n                })}\n            </Select>\n            <button\n              onClick={(e) => handleClick(record.key, parseInt(rol))}\n              className=\"btn btn-outline-primary mx-1\"\n            >\n              Asignar rol\n            </button>\n          </div>\n        );\n      },\n    },\n  ];\n\n  return (\n    <div>\n      <h1 className=\"fs-3 text-secondary p-5 text-center\">\n        <strong>Administrar roles</strong>\n      </h1>\n      <div className=\"table\">\n        <Table dataSource={dataSource} columns={columns} pagination={false} />\n      </div>\n    </div>\n  );\n}\n\nexport default GestorVoluntarios;\n"]},"metadata":{},"sourceType":"module"}