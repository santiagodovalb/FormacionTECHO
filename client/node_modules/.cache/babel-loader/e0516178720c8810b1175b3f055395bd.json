{"ast":null,"code":"import _toConsumableArray from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useSelector}from\"react-redux\";import axios from\"axios\";import{Table}from\"antd\";import{CSVLink}from\"react-csv\";import{totalMinimos,totalOpcionales,totalPendientes,minimos,opcionales,pendientes}from\"./dashUtils\";import useAuthorize from\"../../../utils/authorization\";import\"./DashboardGestor.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function DashboardGestor(){var _user$sede,_user$sede2;var user=useSelector(function(state){return state.user;});var bloques=useSelector(function(state){return state.bloques;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),voluntarios=_useState2[0],setVoluntarios=_useState2[1];useEffect(function(){axios.get(\"/api/users/sede/\".concat(user.sedeId)).then(function(res){return res.data;}).then(function(voluntarios){return setVoluntarios(voluntarios.filter(function(voluntario){return voluntario.rolId>2;}));}).catch(function(err){return err;});},[user,bloques]);useAuthorize(user,2);var dataVoluntarios=voluntarios.map(function(voluntario){return{key:voluntario.id,total:\"\",voluntario:voluntario.full_name,bloquesMinimos:minimos(voluntario,bloques),bloquesOpcionales:opcionales(voluntario,bloques),entregasPendientes:pendientes(voluntario)};});var columns=[{title:\"Entregas pendientes por voluntario\",render:function render(record){return/*#__PURE__*/_jsxs(React.Fragment,{children:[record.voluntario,/*#__PURE__*/_jsx(\"br\",{}),record.entregasPendientes]});},responsive:[\"xs\"]},{title:\"\",dataIndex:\"total\",key:\"total\",responsive:[\"xs\"]},{title:\"\",dataIndex:\"total\",key:\"total\",responsive:[\"sm\"]},{title:\"Voluntario\",dataIndex:\"voluntario\",key:\"voluntario\",responsive:[\"sm\"]},{title:\"Bloques m√≠nimos completados\",dataIndex:\"bloquesMinimos\",key:\"bloquesMinimos\",responsive:[\"sm\"]},{title:\"Bloques opcionales completados\",dataIndex:\"bloquesOpcionales\",key:\"bloquesOpcionales\",responsive:[\"sm\"]},{title:\"Entregas pendientes\",dataIndex:\"entregasPendientes\",key:\"entregasPendientes\",responsive:[\"sm\"]}];var dataSource=[].concat(_toConsumableArray(dataVoluntarios),[{key:\"total\",total:\"Total\",voluntario:voluntarios.length,bloquesMinimos:totalMinimos(voluntarios,bloques),bloquesOpcionales:totalOpcionales(voluntarios,bloques),entregasPendientes:totalPendientes(voluntarios)}]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fs-3 text-secondary p-5 text-center\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"Dashboard de \",(_user$sede=user.sede)===null||_user$sede===void 0?void 0:_user$sede.nombre]})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:dataSource&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success my-3 fs-5\",children:/*#__PURE__*/_jsx(CSVLink,{data:dataSource,filename:\"dashboard-\".concat((_user$sede2=user.sede)===null||_user$sede2===void 0?void 0:_user$sede2.nombre,\".csv\"),children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-light m-0\",children:[\"Descargar \",/*#__PURE__*/_jsx(\"i\",{class:\"bi bi-file-earmark-excel-fill\"})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Table,{bordered:true,columns:columns,dataSource:dataSource,pagination:true})})]})});}","map":null,"metadata":{},"sourceType":"module"}