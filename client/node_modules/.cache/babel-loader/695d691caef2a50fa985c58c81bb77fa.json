{"ast":null,"code":"import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{useSelector}from\"react-redux\";import{useLocation}from\"react-router-dom\";import Swal from\"sweetalert2\";import{Select,message}from\"antd\";import\"./AdminUsers.css\";import useAuthorize from\"../../../utils/authorization\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Option=Select.Option;function Users(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),rol=_useState2[0],setRol=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var user=useSelector(function(state){return state.user;});var roles=useSelector(function(state){return state.roles.filter(function(rol){return rol.id!==1;});});var location=useLocation();var id=location.pathname.slice(21);useEffect(function(){axios.get(\"/api/users/sede/\".concat(id)).then(function(res){return res.data;}).then(function(users){return setUsers(users);});},[user,id]);var handleChange=function handleChange(e){setRol(e);};var handleClick=function handleClick(userId,rolId){axios.post(\"/api/roles/set/\",{userId:userId,rolId:rolId,user:user}).then(function(){return axios.get(\"/api/users/sede/\".concat(id));}).then(function(res){return res.data;}).then(function(users){return setUsers(users);});};var alertaEliminar=Swal.mixin({buttonsStyling:true});var handleDelete=function handleDelete(userId){alertaEliminar.fire({title:\"Estás seguro?\",text:\"Si lo confirmas, no podrás deshacerlo!\",icon:\"warning\",showCancelButton:true,confirmButtonText:\"Si, borrar!\",cancelButtonText:\"No, cancelar!\",confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",reverseButtons:true}).then(function(result){if(result.isConfirmed){alertaEliminar.fire(\"Eliminado!\",\"El usuario fue eliminado correctamente.\",\"success\");axios.delete(\"/api/users/\".concat(userId)).then(function(){return axios.get(\"/api/users/sede/\".concat(id)).then(function(res){return res.data;}).then(function(users){return setUsers(users);});});message.success(\"Usuario eliminado correctamente\");}else if(result.dismiss===Swal.DismissReason.cancel){alertaEliminar.fire(\"Cancelado\",\"El usuario está a salvo\",\"error\");}});};useAuthorize(user,1);return/*#__PURE__*/_jsxs(\"div\",{className:\"admin\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fs-2 text-secondary\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Administrar roles\"})}),!users.length&&/*#__PURE__*/_jsx(\"h1\",{className:\"fs-4\",children:\"No hay voluntarios/gestores en esta sede\"}),/*#__PURE__*/_jsx(\"br\",{}),users&&users.map(function(user){return/*#__PURE__*/_jsxs(\"div\",{className:\"divAdminUser\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"fs-6\",children:[\"Nombre: \",\"  \",/*#__PURE__*/_jsx(\"strong\",{children:user.full_name})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"fs-6\",children:[\"Rol: \",\"  \",/*#__PURE__*/_jsx(\"strong\",{children:user.rol&&user.rol.tipo})]}),/*#__PURE__*/_jsx(Select,{style:{width:200},placeholder:\"Seleccionar rol\",onChange:handleChange,children:roles&&roles.map(function(rol){return/*#__PURE__*/_jsxs(Option,{label:\"children\",value:rol.id,children:[\" \",rol.tipo,\" \"]},rol.id);})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary mx-1\",onClick:function onClick(){return handleClick(user.id,parseInt(rol));},type:\"button\",children:\"Asignar\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-danger mx-1\",onClick:function onClick(){return handleDelete(user.id);},type:\"button\",children:\"Eliminar usuario\"})]},user.id);})]});}export default Users;","map":null,"metadata":{},"sourceType":"module"}