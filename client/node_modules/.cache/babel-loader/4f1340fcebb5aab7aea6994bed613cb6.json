{"ast":null,"code":"import _defineProperty from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import React,{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import Swal from\"sweetalert2\";import{getSedes}from\"../../../redux/sedes\";import{Table,message}from\"antd\";import useAuthorize from\"../../../utils/authorization\";import isValid from\"../../../utils/specialChars\";import\"./AdminSedes.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Sedes(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var sedes=useSelector(function(state){return state.sedes;});var dispatch=useDispatch();var user=useSelector(function(state){return state.user;});var toggleForm=function toggleForm(id){document.getElementById(id).style.display=document.getElementById(id).style.display===\"block\"?\"none\":\"block\";};var handleSubmit=function handleSubmit(e,id){e.preventDefault();if(!isValid(form.nombre))return message.error(\"No se permiten caracteres especiales\");axios.post(\"/api/sedes/\".concat(id),form).then(function(res){return res.data;}).then(function(){return dispatch(getSedes());});};var handleChange=function handleChange(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var alertaEliminar=Swal.mixin({buttonsStyling:true});var handleDelete=function handleDelete(id){alertaEliminar.fire({title:\"Estás seguro?\",text:\"Si lo confirmas, no podrás deshacerlo!\",icon:\"warning\",showCancelButton:true,confirmButtonText:\"Si, borrar!\",cancelButtonText:\"No, cancelar!\",confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",reverseButtons:true}).then(function(result){if(result.isConfirmed){alertaEliminar.fire(\"Eliminado!\",\"La sede fue eliminada correctamente.\",\"success\");axios.delete(\"/api/sedes/\".concat(id)).then(function(){return dispatch(getSedes());});message.success(\"Sede eliminada correctamente\");}else if(result.dismiss===Swal.DismissReason.cancel){alertaEliminar.fire(\"Cancelado\",\"La sede está a salvo\",\"error\");}});};useAuthorize(user,1);var dataSource=sedes.map(function(sede){return{key:sede.id,nombre:sede.nombre,comunidadId:sede.comunidadId};});var columns=[{title:\"Sede\",render:function render(record){return/*#__PURE__*/_jsxs(React.Fragment,{children:[record.nombre,/*#__PURE__*/_jsx(\"hr\",{}),record.comunidadId]});},responsive:[\"xs\"]},{title:\"Sede\",dataIndex:\"nombre\",key:\"nombre\",responsive:[\"sm\"]},{title:\"Comunidad ID\",dataIndex:\"comunidadId\",key:\"comunidadId\",responsive:[\"sm\"]},{title:\"Modificar/eliminar\",key:\"modificar/eliminar\",render:function render(text,record){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDelete(record.key);},className:\"btn btn-outline-danger mx-1\",children:\"Eliminar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return toggleForm(\"sedeForm\".concat(record.key));},className:\"btn btn-outline-primary mx-1\",children:\"Modificar\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"sedesForm\",onSubmit:function onSubmit(e){return handleSubmit(e,record.key);},id:\"sedeForm\".concat(record.key),style:{display:\"none\"},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"nombre\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,type:\"text\",name:\"nombre\",placeholder:record.nombre,className:\"form-control\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"comunidadId\",children:\"Comunidad ID\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,type:\"number\",name:\"comunidadId\",placeholder:record.comunidadId,className:\"form-control\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mx-1\",type:\"submit\",children:\"Confirmar cambios\"})]})]});}}];return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Table,{bordered:true,dataSource:dataSource,columns:columns,pagination:false})});}","map":null,"metadata":{},"sourceType":"module"}