{"ast":null,"code":"import _defineProperty from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import React,{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import Swal from\"sweetalert2\";import{getRoles}from\"../../../redux/roles\";import{Table,message}from\"antd\";import useAuthorize from\"../../../utils/authorization\";import isValid from\"../../../utils/specialChars\";import\"./AdminRoles.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Roles(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var roles=useSelector(function(state){return state.roles;}).filter(function(rol){return rol.id>1;});var dispatch=useDispatch();var user=useSelector(function(state){return state.user;});var toggleForm=function toggleForm(id){document.getElementById(id).style.display=document.getElementById(id).style.display===\"block\"?\"none\":\"block\";};var handleSubmit=function handleSubmit(e,id){e.preventDefault();if(!isValid(form.tipo))return message.error(\"No se permiten caracteres especiales\");axios.put(\"/api/roles/\".concat(id),form).then(function(){dispatch(getRoles());message.success(\"Rol modificado correctamente\");}).catch(function(){return message.error(\"No se pudo modificar\");});};var handleChange=function handleChange(e){setForm(_defineProperty({},e.target.name,e.target.value));};var alertaEliminar=Swal.mixin({buttonsStyling:true});var handleDelete=function handleDelete(id){alertaEliminar.fire({title:\"Estás seguro?\",text:\"Si lo confirmas, no podrás deshacerlo!\",icon:\"warning\",showCancelButton:true,confirmButtonText:\"Si, borrar!\",cancelButtonText:\"No, cancelar!\",confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",reverseButtons:true}).then(function(result){if(result.isConfirmed){alertaEliminar.fire(\"Eliminado!\",\"El rol fue eliminado correctamente.\",\"success\");axios.delete(\"/api/roles/\".concat(id)).then(function(){return dispatch(getRoles());});message.success(\"Rol eliminado correctamente\");}else if(result.dismiss===Swal.DismissReason.cancel){alertaEliminar.fire(\"Cancelado\",\"El rol está a salvo\",\"error\");}});};useAuthorize(user,1);var dataSource=roles.map(function(rol){return{key:rol.id,tipo:rol.tipo};});var columns=[{title:\"Rol\",dataIndex:\"tipo\",key:\"tipo\"},{title:\"Modificar/eliminar\",key:\"modificar/eliminar\",render:function render(text,record){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDelete(record.key);},type:\"button\",className:\"btn btn-outline-danger mx-1\",children:\"Eliminar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return toggleForm(\"rolForm\".concat(record.key));},className:\"btn btn-outline-primary mx-1\",children:\"Modificar\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"rolesForm\",onSubmit:function onSubmit(e){return handleSubmit(e,record.key);},id:\"rolForm\".concat(record.key),style:{display:\"none\"},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"rol-type\",className:\"form-label\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Nombre: \"})}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,type:\"text\",name:\"tipo\",id:\"rol-type\",placeholder:record.tipo,className:\"form-control\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mx-1\",type:\"submit\",children:\"Confirmar cambios\"})]})]});}}];return/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Table,{bordered:true,dataSource:dataSource,columns:columns,pagination:false})});}","map":{"version":3,"sources":["/home/santi/P5/TECHO/formacion-techo/client/src/containers/Admin/AdminRoles/Roles.jsx"],"names":["axios","React","useState","useDispatch","useSelector","Swal","getRoles","Table","message","useAuthorize","isValid","Roles","form","setForm","roles","state","filter","rol","id","dispatch","user","toggleForm","document","getElementById","style","display","handleSubmit","e","preventDefault","tipo","error","put","then","success","catch","handleChange","target","name","value","alertaEliminar","mixin","buttonsStyling","handleDelete","fire","title","text","icon","showCancelButton","confirmButtonText","cancelButtonText","confirmButtonColor","cancelButtonColor","reverseButtons","result","isConfirmed","delete","dismiss","DismissReason","cancel","dataSource","map","key","columns","dataIndex","render","record"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Swal from \"sweetalert2\";\nimport { getRoles } from \"../../../redux/roles\";\nimport { Table, message } from \"antd\";\nimport useAuthorize from \"../../../utils/authorization\";\nimport isValid from \"../../../utils/specialChars\";\nimport \"./AdminRoles.css\";\n\nexport default function Roles() {\n  const [form, setForm] = useState({});\n\n  const roles = useSelector((state) => state.roles).filter((rol) => rol.id > 1);\n  const dispatch = useDispatch();\n  const user = useSelector((state) => state.user);\n\n  const toggleForm = (id) => {\n    document.getElementById(id).style.display =\n      document.getElementById(id).style.display === \"block\" ? \"none\" : \"block\";\n  };\n\n  const handleSubmit = (e, id) => {\n    e.preventDefault();\n    if (!isValid(form.tipo))\n      return message.error(\"No se permiten caracteres especiales\");\n    axios\n      .put(`/api/roles/${id}`, form)\n      .then(() => {\n        dispatch(getRoles());\n        message.success(\"Rol modificado correctamente\");\n      })\n      .catch(() => message.error(\"No se pudo modificar\"));\n  };\n\n  const handleChange = (e) => {\n    setForm({ [e.target.name]: e.target.value });\n  };\n\n  const alertaEliminar = Swal.mixin({\n    buttonsStyling: true,\n  });\n\n  const handleDelete = (id) => {\n    alertaEliminar\n      .fire({\n        title: \"Estás seguro?\",\n        text: \"Si lo confirmas, no podrás deshacerlo!\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonText: \"Si, borrar!\",\n        cancelButtonText: \"No, cancelar!\",\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        reverseButtons: true,\n      })\n      .then((result) => {\n        if (result.isConfirmed) {\n          alertaEliminar.fire(\n            \"Eliminado!\",\n            \"El rol fue eliminado correctamente.\",\n            \"success\"\n          );\n          axios.delete(`/api/roles/${id}`).then(() => dispatch(getRoles()));\n          message.success(\"Rol eliminado correctamente\");\n        } else if (result.dismiss === Swal.DismissReason.cancel) {\n          alertaEliminar.fire(\"Cancelado\", \"El rol está a salvo\", \"error\");\n        }\n      });\n  };\n\n  useAuthorize(user, 1);\n\n  const dataSource = roles.map((rol) => {\n    return {\n      key: rol.id,\n      tipo: rol.tipo,\n    };\n  });\n\n  const columns = [\n    {\n      title: \"Rol\",\n      dataIndex: \"tipo\",\n      key: \"tipo\",\n    },\n    {\n      title: \"Modificar/eliminar\",\n      key: \"modificar/eliminar\",\n      render: (text, record) => {\n        return (\n          <div>\n            <button\n              onClick={() => handleDelete(record.key)}\n              type=\"button\"\n              className=\"btn btn-outline-danger mx-1\"\n            >\n              Eliminar\n            </button>\n            <button\n              onClick={() => toggleForm(`rolForm${record.key}`)}\n              className=\"btn btn-outline-primary mx-1\"\n            >\n              Modificar\n            </button>\n            <form\n              className=\"rolesForm\"\n              onSubmit={(e) => handleSubmit(e, record.key)}\n              id={`rolForm${record.key}`}\n              style={{ display: \"none\" }}\n            >\n              <label htmlFor=\"rol-type\" className=\"form-label\">\n                <strong>Nombre: </strong>\n              </label>\n              <input\n                onChange={handleChange}\n                type=\"text\"\n                name=\"tipo\"\n                id=\"rol-type\"\n                placeholder={record.tipo}\n                className=\"form-control\"\n              ></input>\n              <button className=\"btn btn-success mx-1\" type=\"submit\">\n                Confirmar cambios\n              </button>\n            </form>\n          </div>\n        );\n      },\n    },\n  ];\n\n  return (\n    <div className=\"table\">\n      <Table\n        bordered\n        dataSource={dataSource}\n        columns={columns}\n        pagination={false}\n      />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}