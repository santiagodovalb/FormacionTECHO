{"ast":null,"code":"import _defineProperty from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import React,{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import Swal from\"sweetalert2\";import{getRoles}from\"../../../redux/roles\";import{Table,message}from\"antd\";import useAuthorize from\"../../../utils/authorization\";import isValid from\"../../../utils/specialChars\";import\"./AdminRoles.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Roles(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var roles=useSelector(function(state){return state.roles;}).filter(function(rol){return rol.id>1;});var dispatch=useDispatch();var user=useSelector(function(state){return state.user;});var toggleForm=function toggleForm(id){document.getElementById(id).style.display=document.getElementById(id).style.display===\"block\"?\"none\":\"block\";};var handleSubmit=function handleSubmit(e,id){e.preventDefault();if(!isValid(form.tipo))return message.error(\"No se permiten caracteres especiales\");axios.put(\"/api/roles/\".concat(id),form).then(function(){dispatch(getRoles());message.success(\"Rol modificado correctamente\");}).catch(function(){return message.error(\"No se pudo modificar\");});};var handleChange=function handleChange(e){setForm(_defineProperty({},e.target.name,e.target.value));};var alertaEliminar=Swal.mixin({buttonsStyling:true});var handleDelete=function handleDelete(id){alertaEliminar.fire({title:\"Estás seguro?\",text:\"Si lo confirmas, no podrás deshacerlo!\",icon:\"warning\",showCancelButton:true,confirmButtonText:\"Si, borrar!\",cancelButtonText:\"No, cancelar!\",confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",reverseButtons:true}).then(function(result){if(result.isConfirmed){alertaEliminar.fire(\"Eliminado!\",\"El rol fue eliminado correctamente.\",\"success\");axios.delete(\"/api/roles/\".concat(id)).then(function(){return dispatch(getRoles());});message.success(\"Rol eliminado correctamente\");}else if(result.dismiss===Swal.DismissReason.cancel){alertaEliminar.fire(\"Cancelado\",\"El rol está a salvo\",\"error\");}});};useAuthorize(user,1);var dataSource=roles.map(function(rol){return{key:rol.id,tipo:rol.tipo};});var columns=[{title:\"Rol\",dataIndex:\"tipo\",key:\"tipo\"},{title:\"Modificar/eliminar\",key:\"modificar/eliminar\",render:function render(text,record){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDelete(record.key);},type:\"button\",className:\"btn btn-outline-danger mx-1\",children:\"Eliminar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return toggleForm(\"rolForm\".concat(record.key));},className:\"btn btn-outline-primary mx-1\",children:\"Modificar\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"rolesForm\",onSubmit:function onSubmit(e){return handleSubmit(e,record.key);},id:\"rolForm\".concat(record.key),style:{display:\"none\"},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"rol-type\",className:\"form-label\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Nombre: \"})}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,type:\"text\",name:\"tipo\",id:\"rol-type\",placeholder:record.tipo,className:\"form-control\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mx-1\",type:\"submit\",children:\"Confirmar cambios\"})]})]});}}];return/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Table,{bordered:true,dataSource:dataSource,columns:columns,pagination:false})});}","map":null,"metadata":{},"sourceType":"module"}