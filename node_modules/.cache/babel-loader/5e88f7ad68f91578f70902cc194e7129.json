{"ast":null,"code":"import _defineProperty from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/santi/P5/TECHO/formacion-techo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import\"../Login\";import{useDispatch}from\"react-redux\";import{setUser}from\"../../../redux/user\";import{useHistory}from\"react-router\";import axios from'axios';import{message}from'antd';import'antd/dist/antd.css';import validator from'validator';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginAdmin=function LoginAdmin(){var dispatch=useDispatch();var history=useHistory();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var onChange=function onChange(e){var target=e.target;setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},target.name,target.value)));};var isEmail=function isEmail(){return validator.isEmail(form.email);};var onSubmit=function onSubmit(e){e.preventDefault();if(isEmail()){axios.post(\"/api/users/login\",form).then(function(res){return res.data;}).then(function(user){return axios.get(\"/api/users/\".concat(user.id));}).then(function(res){return res.data;}).then(function(user){dispatch(setUser(user));message.success('Logged in');history.push(\"/user\");}).catch(function(err){message.error('Bad credentials');return err;});}};return/*#__PURE__*/_jsxs(\"form\",{className:\"pb-3\",onChange:onChange,onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",name:\"email\",placeholder:\"Correo\",required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",placeholder:\"Contrase\\xF1a\",required:true})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-secondary mt-3\",children:\"Ingresar\"})]});};export default LoginAdmin;","map":{"version":3,"sources":["/home/santi/P5/TECHO/formacion-techo/src/containers/Login/ModuleLogin/LoginAdmin.jsx"],"names":["React","useState","useDispatch","setUser","useHistory","axios","message","validator","LoginAdmin","dispatch","history","form","setForm","onChange","e","target","name","value","isEmail","email","onSubmit","preventDefault","post","then","res","data","user","get","id","success","push","catch","err","error"],"mappings":"sWAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,MAAO,UAAP,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,OAAT,KAAwB,qBAAxB,CAEA,OAASC,UAAT,KAA2B,cAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,OAAT,KAAwB,MAAxB,CACA,MAAO,oBAAP,CACA,MAAOC,CAAAA,SAAP,KAAsB,WAAtB,C,wFAIA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CAErB,GAAOC,CAAAA,QAAQ,CAAGP,WAAW,EAA7B,CACA,GAAMQ,CAAAA,OAAO,CAAGN,UAAU,EAA1B,CACA,cAAwBH,QAAQ,CAAC,EAAD,CAAhC,wCAAOU,IAAP,eAAaC,OAAb,eAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,CAAD,CAAO,CACtB,GAAQC,CAAAA,MAAR,CAAmBD,CAAnB,CAAQC,MAAR,CACAH,OAAO,gCAAMD,IAAN,wBAAaI,MAAM,CAACC,IAApB,CAA2BD,MAAM,CAACE,KAAlC,GAAP,CAED,CAJD,CAKA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,SAAMX,CAAAA,SAAS,CAACW,OAAV,CAAkBP,IAAI,CAACQ,KAAvB,CAAN,EAAhB,CAGA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACN,CAAD,CAAO,CACtBA,CAAC,CAACO,cAAF,GACA,GAAGH,OAAO,EAAV,CAAc,CACdb,KAAK,CAACiB,IAAN,CAAW,kBAAX,CAA+BX,IAA/B,EACCY,IADD,CACM,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAR,EADT,EAECF,IAFD,CAEM,SAAAG,IAAI,CAAI,CACZ,MAAOrB,CAAAA,KAAK,CAACsB,GAAN,sBAAwBD,IAAI,CAACE,EAA7B,EAAP,CACD,CAJD,EAKCL,IALD,CAKM,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAR,EALT,EAMCF,IAND,CAMM,SAAAG,IAAI,CAAI,CACZjB,QAAQ,CAACN,OAAO,CAACuB,IAAD,CAAR,CAAR,CACApB,OAAO,CAACuB,OAAR,CAAgB,WAAhB,EACAnB,OAAO,CAACoB,IAAR,UACD,CAVD,EAWCC,KAXD,CAWO,SAAAC,GAAG,CAAI,CACZ1B,OAAO,CAAC2B,KAAR,CAAc,iBAAd,EACA,MAAOD,CAAAA,GAAP,CACD,CAdD,EAgBD,CAAC,CAnBF,CAwBA,mBACI,cAAM,SAAS,CAAC,MAAhB,CAAuB,QAAQ,CAAEnB,QAAjC,CAA2C,QAAQ,CAAEO,QAArD,wBACE,YAAK,SAAS,CAAC,MAAf,uBACE,cACE,IAAI,CAAC,OADP,CAEE,SAAS,CAAC,cAFZ,CAGE,IAAI,CAAC,OAHP,CAIE,WAAW,CAAC,QAJd,CAKE,QAAQ,KALV,EADF,EADF,cAUE,YAAK,SAAS,CAAC,MAAf,uBACE,cACE,IAAI,CAAC,UADP,CAEE,SAAS,CAAC,cAFZ,CAGE,IAAI,CAAC,UAHP,CAIE,WAAW,CAAC,eAJd,CAKE,QAAQ,KALV,EADF,EAVF,cAmBE,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,wBAAhC,sBAnBF,GADJ,CA0BH,CAhED,CAkEA,cAAeZ,CAAAA,UAAf","sourcesContent":["import React, { useState } from \"react\";\nimport \"../Login\";\nimport { useDispatch } from \"react-redux\";\nimport { setUser } from \"../../../redux/user\";\n\nimport { useHistory } from \"react-router\";\nimport axios from 'axios'\nimport { message } from 'antd'\nimport 'antd/dist/antd.css';\nimport validator from 'validator';\n\n\n\nconst LoginAdmin = () => {\n\n    const  dispatch = useDispatch()\n    const history = useHistory()\n    const [form, setForm] = useState({});\n  \n    const onChange = (e) => {\n      const { target } = e;\n      setForm({ ...form, [target.name]: target.value });\n      \n    };\n    const isEmail = () => validator.isEmail(form.email)\n\n  \n    const onSubmit = (e) => {\n      e.preventDefault();\n      if(isEmail()) {\n      axios.post(\"/api/users/login\", form)\n      .then(res => res.data)\n      .then(user => {\n        return axios.get(`/api/users/${user.id}`)\n      })\n      .then(res => res.data)\n      .then(user => {\n        dispatch(setUser(user))\n        message.success('Logged in')\n        history.push(`/user`)\n      })\n      .catch(err => {\n        message.error('Bad credentials')\n        return err\n      })\n      \n    }};\n  \n\n    \n\n    return (\n        <form className=\"pb-3\" onChange={onChange} onSubmit={onSubmit}>\n          <div className=\"mb-3\">\n            <input\n              type=\"email\"\n              className=\"form-control\"\n              name=\"email\"\n              placeholder=\"Correo\"\n              required\n            />\n          </div>\n          <div className=\"mb-3\">\n            <input\n              type=\"password\"\n              className=\"form-control\"\n              name=\"password\"\n              placeholder=\"ContraseÃ±a\"\n              required\n            />\n          </div>\n          <button type=\"submit\" className=\"btn btn-secondary mt-3\">\n            Ingresar\n          </button>\n        </form>\n    )\n\n}\n\nexport default LoginAdmin;"]},"metadata":{},"sourceType":"module"}