{"ast":null,"code":"var _jsxFileName = \"/home/santi/P5/TECHO/formacion-techo/src/containers/Admin/AdminBloques/ModificarBloque.jsx\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { Form, Input, Radio, Checkbox, Col, Row } from \"antd\";\nimport Swal from \"sweetalert2\";\nimport { getBloques } from \"../../../redux/bloques\";\nimport AdminUnidades from \"../AdminUnidades/index.jsx\";\nimport Unidades from \"./Unidades.jsx\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst {\n  TextArea\n} = Input;\nexport default function ModificarBloque() {\n  _s();\n\n  const [count, setCount] = useState(0);\n  const [bloque, setBloque] = useState();\n  const [showForm, setShowForm] = useState(false);\n  const [form, setForm] = useState({\n    bloque\n  });\n  const {\n    id\n  } = useParams();\n  const user = useSelector(state => state.user);\n  const roles = useSelector(state => state.roles).filter(rol => rol.id > 2);\n  const history = useHistory();\n  const dispatch = useDispatch();\n  useEffect(() => {\n    axios.get(`/api/bloques/${id}`).then(res => res.data).then(bloque => {\n      setForm({\n        titulo: bloque.titulo,\n        descripcion: bloque.descripcion,\n        minimo: bloque.minimo,\n        rolesId: bloque.roles.map(rol => rol.id)\n      });\n      setBloque(bloque);\n      return bloque;\n    }).then(bloque => {\n      const rolesIds = roles.map(rol => rol.id);\n\n      for (let i = 0; i < roles.length; i++) {\n        document.getElementById(`rol${rolesIds[i]}`).checked = bloque.roles.map(rol => rol.id).includes(rolesIds[i]) && \"true\";\n      }\n\n      document.getElementById(\"minimoSi\").checked = bloque.minimo && \"true\";\n      document.getElementById(\"minimoNo\").checked = !bloque.minimo && \"true\";\n    });\n  }, [showForm, count]);\n\n  const handleChange = e => {\n    setForm({ ...form,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleMinimo = e => {\n    let boolean = e.target.id === \"si\" ? true : false;\n    setForm({ ...form,\n      minimo: boolean\n    });\n  };\n\n  const handleRoles = e => {\n    let array = [...form.rolesId];\n    e.target.checked ? array = [...array, e.target.value] : array.splice(form.rolesId.indexOf(e.target.value), 1);\n    setForm({ ...form,\n      rolesId: [...array]\n    });\n  };\n\n  const handleSubmit = e => {\n    axios.put(`/api/bloques/${id}`, form).then(() => {\n      dispatch(getBloques());\n      history.push(\"/admin-bloques\");\n    });\n  };\n\n  const alertaEliminar = Swal.mixin({\n    customClass: {\n      confirmButton: \"btn btn-success\",\n      cancelButton: \"btn btn-danger\"\n    },\n    buttonsStyling: true\n  });\n\n  const handleDelete = () => {\n    alertaEliminar.fire({\n      title: \"Estás seguro?\",\n      text: \"Si lo confirmas, no podrás deshacerlo!\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonText: \"Si, borrar!\",\n      cancelButtonText: \"No, cancelar!\",\n      reverseButtons: true\n    }).then(result => {\n      if (result.isConfirmed) {\n        alertaEliminar.fire(\"Eliminado!\", \"El bloque fue eliminado correctamente.\", \"success\");\n        axios.delete(`/api/bloques/${id}`).then(() => {\n          dispatch(getBloques());\n          history.push(\"/admin-bloques\");\n        });\n      } else if (result.dismiss === Swal.DismissReason.cancel) {\n        alertaEliminar.fire(\"Cancelado\", \"El bloque está a salvo\", \"error\");\n      }\n    });\n  };\n\n  const toggleUnidad = () => {\n    setShowForm(!showForm);\n  };\n\n  if (user.rolId && user.rolId !== 1) {\n    history.push(\"/unauthorized\");\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"No autorizado\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  }\n\n  const forceRender = () => {\n    setCount(count + 1);\n  };\n\n  useAuthorize(user, 1);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: bloque && bloque.titulo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), bloque && /*#__PURE__*/_jsxDEV(Form, {\n      labelCol: {\n        span: 5\n      },\n      wrapperCol: {\n        span: 13\n      },\n      onFinish: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n        label: \"Titulo\",\n        children: /*#__PURE__*/_jsxDEV(Input, {\n          className: \"admin_input\",\n          type: \"text\",\n          name: \"titulo\",\n          onChange: handleChange,\n          defaultValue: bloque.titulo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n        label: \"Descripci\\xF3n\",\n        children: /*#__PURE__*/_jsxDEV(TextArea, {\n          autoSize: true,\n          className: \"admin_input\",\n          showCount: true,\n          maxLength: 350,\n          defaultValue: bloque.descripcion,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n        label: \"Pregunta\",\n        children: /*#__PURE__*/_jsxDEV(Input, {\n          className: \"admin_input\",\n          type: \"text\",\n          name: \"titulo\",\n          onChange: handleChange,\n          defaultValue: bloque.pregunta\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          children: \"Es bloque m\\xEDnimo?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Radio.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Radio.Button, {\n            id: \"si\",\n            id: \"minimoSi\",\n            value: \"si\",\n            onChange: handleMinimo,\n            children: \"Si\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n            id: \"no\",\n            id: \"minimoNo\",\n            value: \"no\",\n            onChange: handleMinimo,\n            children: \"No\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n          children: \"A que roles esta destinado?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this), roles.map(rol => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"admin_check\",\n              htmlFor: rol.tipo,\n              children: rol.tipo\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              name: \"roles\",\n              value: rol.id,\n              id: `rol${rol.id}`,\n              onChange: handleRoles\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 17\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin\",\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            pull: 1,\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"mb-3 mt-3 p-3 fs-3 button-style green\",\n              type: \"button\",\n              onClick: handleDelete,\n              children: \"Eliminar bloque\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            push: 1,\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"mb-3 mt-3 p-3 fs-3 button-style light-blue\",\n              type: \"submit\",\n              children: \"Modificar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"mb-3 mt-3 p-3 fs-3 button-style light-blue\",\n          type: \"button\",\n          onClick: toggleUnidad,\n          children: \"Agregar unidad al bloque\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin\",\n      children: [showForm && /*#__PURE__*/_jsxDEV(AdminUnidades, {\n        forceRender: forceRender,\n        bloque: bloque\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 22\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Unidades del bloque\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Unidades, {\n      forceRender: forceRender,\n      unidades: bloque === null || bloque === void 0 ? void 0 : bloque.unidades\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ModificarBloque, \"+8nFa8R68zpdtvhIppwPzwL303o=\", true, function () {\n  return [useParams, useSelector, useSelector, useHistory, useDispatch];\n});\n\n_c = ModificarBloque;\n\nvar _c;\n\n$RefreshReg$(_c, \"ModificarBloque\");","map":{"version":3,"sources":["/home/santi/P5/TECHO/formacion-techo/src/containers/Admin/AdminBloques/ModificarBloque.jsx"],"names":["axios","React","useEffect","useState","useDispatch","useSelector","useHistory","useParams","Form","Input","Radio","Checkbox","Col","Row","Swal","getBloques","AdminUnidades","Unidades","TextArea","ModificarBloque","count","setCount","bloque","setBloque","showForm","setShowForm","form","setForm","id","user","state","roles","filter","rol","history","dispatch","get","then","res","data","titulo","descripcion","minimo","rolesId","map","rolesIds","i","length","document","getElementById","checked","includes","handleChange","e","target","name","value","handleMinimo","boolean","handleRoles","array","splice","indexOf","handleSubmit","put","push","alertaEliminar","mixin","customClass","confirmButton","cancelButton","buttonsStyling","handleDelete","fire","title","text","icon","showCancelButton","confirmButtonText","cancelButtonText","reverseButtons","result","isConfirmed","delete","dismiss","DismissReason","cancel","toggleUnidad","rolId","forceRender","useAuthorize","span","pregunta","tipo","unidades"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { Form, Input, Radio, Checkbox, Col, Row } from \"antd\";\nimport Swal from \"sweetalert2\";\nimport { getBloques } from \"../../../redux/bloques\";\nimport AdminUnidades from \"../AdminUnidades/index.jsx\";\nimport Unidades from \"./Unidades.jsx\";\nconst { TextArea } = Input;\n\nexport default function ModificarBloque() {\n  \n  const [count, setCount] = useState(0);\n  const [bloque, setBloque] = useState();\n  const [showForm, setShowForm] = useState(false);\n  const [form, setForm] = useState({ bloque });\n  const { id } = useParams();\n  const user = useSelector((state) => state.user);\n  const roles = useSelector((state) => state.roles).filter((rol) => rol.id > 2);\n  const history = useHistory();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    axios\n      .get(`/api/bloques/${id}`)\n      .then((res) => res.data)\n      .then((bloque) => {\n        setForm({\n          titulo: bloque.titulo,\n          descripcion: bloque.descripcion,\n          minimo: bloque.minimo,\n          rolesId: bloque.roles.map((rol) => rol.id),\n        });\n        setBloque(bloque);\n\n        return bloque;\n      })\n      .then((bloque) => {\n        const rolesIds = roles.map((rol) => rol.id);\n        for (let i = 0; i < roles.length; i++) {\n          document.getElementById(`rol${rolesIds[i]}`).checked =\n            bloque.roles.map((rol) => rol.id).includes(rolesIds[i]) && \"true\";\n        }\n        document.getElementById(\"minimoSi\").checked = bloque.minimo && \"true\";\n        document.getElementById(\"minimoNo\").checked = !bloque.minimo && \"true\";\n      });\n  }, [showForm, count]);\n\n  const handleChange = (e) => {\n    setForm({ ...form, [e.target.name]: e.target.value });\n  };\n\n  const handleMinimo = (e) => {\n    let boolean = e.target.id === \"si\" ? true : false;\n    setForm({ ...form, minimo: boolean });\n  };\n\n  const handleRoles = (e) => {\n    let array = [...form.rolesId];\n    e.target.checked\n      ? (array = [...array, e.target.value])\n      : array.splice(form.rolesId.indexOf(e.target.value), 1);\n    setForm({ ...form, rolesId: [...array] });\n  };\n\n  const handleSubmit = (e) => {\n    axios.put(`/api/bloques/${id}`, form).then(() => {\n      dispatch(getBloques());\n      history.push(\"/admin-bloques\");\n    });\n  };\n\n  const alertaEliminar = Swal.mixin({\n    customClass: {\n      confirmButton: \"btn btn-success\",\n      cancelButton: \"btn btn-danger\",\n    },\n    buttonsStyling: true,\n  });\n\n  const handleDelete = () => {\n    alertaEliminar\n      .fire({\n        title: \"Estás seguro?\",\n        text: \"Si lo confirmas, no podrás deshacerlo!\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonText: \"Si, borrar!\",\n        cancelButtonText: \"No, cancelar!\",\n        reverseButtons: true,\n      })\n      .then((result) => {\n        if (result.isConfirmed) {\n          alertaEliminar.fire(\n            \"Eliminado!\",\n            \"El bloque fue eliminado correctamente.\",\n            \"success\"\n          );\n          axios.delete(`/api/bloques/${id}`).then(() => {\n            dispatch(getBloques());\n            history.push(\"/admin-bloques\");\n          });\n        } else if (result.dismiss === Swal.DismissReason.cancel) {\n          alertaEliminar.fire(\"Cancelado\", \"El bloque está a salvo\", \"error\");\n        }\n      });\n  };\n\n  const toggleUnidad = () => {\n    setShowForm(!showForm);\n  };\n\n  if (user.rolId && user.rolId !== 1) {\n    history.push(\"/unauthorized\");\n    return (\n      <>\n        <h1>No autorizado</h1>\n      </>\n    );\n  }\n\n  const forceRender = () => {\n    setCount(count + 1)\n  }\n\n  useAuthorize(user, 1)\n\n  return (\n    <div>\n      <div className=\"admin\">\n        <h1>{bloque && bloque.titulo}</h1>\n      </div>\n      {bloque && (\n        <Form\n          labelCol={{\n            span: 5,\n          }}\n          wrapperCol={{\n            span: 13,\n          }}\n          onFinish={handleSubmit}\n        >\n          <Form.Item label=\"Titulo\">\n            <Input\n              className=\"admin_input\"\n              type=\"text\"\n              name=\"titulo\"\n              onChange={handleChange}\n              defaultValue={bloque.titulo}\n            ></Input>\n          </Form.Item>\n          <Form.Item label=\"Descripción\">\n            <TextArea\n              autoSize={true}\n              className=\"admin_input\"\n              showCount\n              maxLength={350}\n              defaultValue={bloque.descripcion}\n              onChange={handleChange}\n            ></TextArea>\n          </Form.Item>\n          <Form.Item label=\"Pregunta\">\n            <Input\n              className=\"admin_input\"\n              type=\"text\"\n              name=\"titulo\"\n              onChange={handleChange}\n              defaultValue={bloque.pregunta}\n            ></Input>\n          </Form.Item>\n\n          <div className=\"admin\">\n            <h5>Es bloque mínimo?</h5>\n            <Radio.Group>\n              <Radio.Button\n                id=\"si\"\n                id=\"minimoSi\"\n                value=\"si\"\n                onChange={handleMinimo}\n              >\n                Si\n              </Radio.Button>\n              <Radio.Button\n                id=\"no\"\n                id=\"minimoNo\"\n                value=\"no\"\n                onChange={handleMinimo}\n              >\n                No\n              </Radio.Button>\n            </Radio.Group>\n            <br />\n            <h5>A que roles esta destinado?</h5>\n\n            {roles.map((rol) => {\n              return (\n                <div>\n                  <label className=\"admin_check\" htmlFor={rol.tipo}>\n                    {rol.tipo}\n                  </label>\n                  <input\n                    type=\"checkbox\"\n                    name=\"roles\"\n                    value={rol.id}\n                    id={`rol${rol.id}`}\n                    onChange={handleRoles}\n                  />\n                </div>\n              );\n            })}\n          </div>\n\n          <div className=\"admin\">\n            <Row>\n              <Col pull={1}>\n                <button\n                  className=\"mb-3 mt-3 p-3 fs-3 button-style green\"\n                  type=\"button\"\n                  onClick={handleDelete}\n                >\n                  Eliminar bloque\n                </button>\n              </Col>\n              <Col push={1}>\n                <button\n                  className=\"mb-3 mt-3 p-3 fs-3 button-style light-blue\"\n                  type=\"submit\"\n                >\n                  Modificar\n                </button>\n              </Col>\n            </Row>\n\n            <button\n              className=\"mb-3 mt-3 p-3 fs-3 button-style light-blue\"\n              type=\"button\"\n              onClick={toggleUnidad}\n            >\n              Agregar unidad al bloque\n            </button>\n          </div>\n        </Form>\n      )}\n      <div className=\"admin\">\n        {showForm && <AdminUnidades forceRender={forceRender} bloque={bloque} />}\n        <br />\n        <h1>Unidades del bloque</h1>\n        <br />\n      </div>\n      <Unidades forceRender={forceRender} unidades={bloque?.unidades} />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}